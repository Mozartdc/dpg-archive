name: Notion ìë™ ë™ê¸°í™”

on:
  schedule:
    # 6ì‹œê°„ë§ˆë‹¤ ìë™ ì‹¤í–‰ (UTC 0ì‹œ, 6ì‹œ, 12ì‹œ, 18ì‹œ)
    # í•œêµ­ì‹œê°„ìœ¼ë¡œ ì˜¤ì „ 9ì‹œ, ì˜¤í›„ 3ì‹œ, ì˜¤í›„ 9ì‹œ, ì˜¤ì „ 3ì‹œ
    - cron: '0 */6 * * *'
  
  # GitHub Actions íƒ­ì—ì„œ ìˆ˜ë™ ì‹¤í–‰ ê°€ëŠ¥
  workflow_dispatch:

jobs:
  sync-notion:
    runs-on: ubuntu-latest
    
    permissions:
      contents: write  # ì €ì¥ì†Œ ìˆ˜ì • ê¶Œí•œ
    
    steps:
      - name: ì €ì¥ì†Œ ì²´í¬ì•„ì›ƒ
        uses: actions/checkout@v4
      
      - name: Node.js ì„¤ì •
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'
      
      - name: ì˜ì¡´ì„± ì„¤ì¹˜
        run: npm ci
      
      - name: ë…¸ì…˜ ë™ê¸°í™” ì‹¤í–‰
        env:
          NOTION_DATABASE_ID: ${{ secrets.NOTION_DATABASE_ID }}
          NOTION_API_KEY: ${{ secrets.NOTION_API_KEY }}
        run: npm run sync
      
      - name: ë³€ê²½ì‚¬í•­ ì»¤ë°‹ ë° í‘¸ì‹œ
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          commit_message: "ğŸ¤– ë…¸ì…˜ ì½˜í…ì¸  ìë™ ì—…ë°ì´íŠ¸ [skip ci]"
          branch: main
